
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Quick introduction &#8212; erddapy 0.1.7+3.ga4abd92 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Searching datasets" href="searchfor.html" />
    <link rel="prev" title="erddapy" href="erddapy.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/logo.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=pyoceans&repo=erddapy&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a href="https://travis-ci.org/pyoceans/erddapy">
    <img
        alt="https://secure.travis-ci.org/pyoceans/erddapy.svg?branch=master"
        src="https://secure.travis-ci.org/pyoceans/erddapy.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="erddapy.html"><code class="docutils literal notranslate"><span class="pre">erddapy</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="erddapy.html#extras"><code class="docutils literal notranslate"><span class="pre">extras</span></code></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quick introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="#Longer-introduction">Longer introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Extras">Extras</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#OPeNDAP-response">OPeNDAP response</a></li>
<li class="toctree-l3"><a class="reference internal" href="#netCDF-“file-like”-to-xarray">netCDF “file-like” to xarray</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="searchfor.html">Searching datasets</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="erddapy.html" title="previous chapter"><code class="docutils literal notranslate"><span class="pre">erddapy</span></code></a></li>
      <li>Next: <a href="searchfor.html" title="next chapter">Searching datasets</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<div class="section" id="Quick-introduction">
<h1>Quick introduction<a class="headerlink" href="#Quick-introduction" title="Permalink to this headline">¶</a></h1>
<p>First we need to instantiate the erddapy server object.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">erddapy</span> <span class="k">import</span> <span class="n">ERDDAP</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<span class="n">e</span> <span class="o">=</span> <span class="n">ERDDAP</span><span class="p">(</span>
    <span class="n">server</span><span class="o">=</span><span class="s1">&#39;https://data.ioos.us/gliders/erddap&#39;</span><span class="p">,</span>
    <span class="n">protocol</span><span class="o">=</span><span class="s1">&#39;tabledap&#39;</span><span class="p">,</span>
    <span class="n">response</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we can populate the object with constraints, the variables of
interest and the dataset id.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">e</span><span class="o">.</span><span class="n">dataset_id</span> <span class="o">=</span> <span class="s1">&#39;blue-20160818T1448&#39;</span>

<span class="n">e</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;time&gt;=&#39;</span><span class="p">:</span> <span class="s1">&#39;2016-07-10T00:00:00Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;time&lt;=&#39;</span><span class="p">:</span> <span class="s1">&#39;2017-02-10T00:00:00Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;latitude&gt;=&#39;</span><span class="p">:</span> <span class="mf">38.0</span><span class="p">,</span>
    <span class="s1">&#39;latitude&lt;=&#39;</span><span class="p">:</span> <span class="mf">41.0</span><span class="p">,</span>
    <span class="s1">&#39;longitude&gt;=&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">72.0</span><span class="p">,</span>
    <span class="s1">&#39;longitude&lt;=&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">69.0</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">e</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;depth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
    <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
    <span class="s1">&#39;salinity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;temperature&#39;</span><span class="p">,</span>
    <span class="s1">&#39;time&#39;</span><span class="p">,</span>
<span class="p">]</span>


<span class="n">url</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">get_download_url</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
https://data.ioos.us/gliders/erddap/tabledap/blue-20160818T1448.csv?depth,latitude,longitude,salinity,temperature,time&amp;time&gt;=1468108800.0&amp;time&lt;=1486684800.0&amp;latitude&gt;=38.0&amp;latitude&lt;=41.0&amp;longitude&gt;=-72.0&amp;longitude&lt;=-69.0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(</span>
    <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">skiprows</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,)</span>  <span class="c1"># units information can be dropped.</span>
<span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>depth</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>salinity</th>
      <th>temperature</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-08-19 17:41:53</th>
      <td>4.58</td>
      <td>40.997572</td>
      <td>-70.953544</td>
      <td>32.241924</td>
      <td>22.1122</td>
    </tr>
    <tr>
      <th>2016-08-19 17:41:53</th>
      <td>5.92</td>
      <td>40.997572</td>
      <td>-70.953544</td>
      <td>32.231640</td>
      <td>21.9331</td>
    </tr>
    <tr>
      <th>2016-08-19 17:41:53</th>
      <td>7.09</td>
      <td>40.997572</td>
      <td>-70.953544</td>
      <td>32.225613</td>
      <td>21.7394</td>
    </tr>
    <tr>
      <th>2016-08-19 17:41:53</th>
      <td>8.25</td>
      <td>40.997572</td>
      <td>-70.953544</td>
      <td>32.231335</td>
      <td>21.3219</td>
    </tr>
    <tr>
      <th>2016-08-19 17:41:53</th>
      <td>10.11</td>
      <td>40.997572</td>
      <td>-70.953544</td>
      <td>32.286210</td>
      <td>19.7151</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                <span class="n">c</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">xfmt</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%H:%Mh</span><span class="se">\n</span><span class="si">%d</span><span class="s1">-%b&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">xfmt</span><span class="p">)</span>

<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature ($^\circ$C)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (m)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/quick_intro_6_0.png" src="_images/quick_intro_6_0.png" />
</div>
</div>
</div>
<div class="section" id="Longer-introduction">
<h1>Longer introduction<a class="headerlink" href="#Longer-introduction" title="Permalink to this headline">¶</a></h1>
<p>First we need to instantiate the <code class="docutils literal notranslate"><span class="pre">ERDDAP</span></code> URL constructor for a
server. In this example we will use <a class="reference external" href="https://data.ioos.us/gliders/erddap">https://data.ioos.us/gliders/erddap</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">erddapy</span> <span class="k">import</span> <span class="n">ERDDAP</span>


<span class="n">e</span> <span class="o">=</span> <span class="n">ERDDAP</span><span class="p">(</span><span class="n">server</span><span class="o">=</span><span class="s1">&#39;https://data.ioos.us/gliders/erddap&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>What are the methods/attributes available?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">[</span><span class="n">method</span> <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">method</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[6]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&#39;constraints&#39;,
 &#39;dataset_id&#39;,
 &#39;get_download_url&#39;,
 &#39;get_info_url&#39;,
 &#39;get_search_url&#39;,
 &#39;get_var_by_attr&#39;,
 &#39;params&#39;,
 &#39;protocol&#39;,
 &#39;requests_kwargs&#39;,
 &#39;response&#39;,
 &#39;server&#39;,
 &#39;to_pandas&#39;,
 &#39;to_xarray&#39;,
 &#39;variables&#39;]
</pre></div>
</div>
</div>
<p>All the <code class="docutils literal notranslate"><span class="pre">get_&lt;methods&gt;</span></code> will return a valid <code class="docutils literal notranslate"><span class="pre">ERDDAP</span></code> URL for the
requested response and options. <code class="docutils literal notranslate"><span class="pre">erddapy</span></code> will raise an error is if
URL HEADER cannot be validated.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">get_search_url</span><span class="p">(</span><span class="n">search_for</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
https://data.ioos.us/gliders/erddap/search/advanced.html?page=1&amp;itemsPerPage=1000&amp;protocol=(ANY)&amp;cdm_data_type=(ANY)&amp;institution=(ANY)&amp;ioos_category=(ANY)&amp;keywords=(ANY)&amp;long_name=(ANY)&amp;standard_name=(ANY)&amp;variableName=(ANY)&amp;minLon=(ANY)&amp;maxLon=(ANY)&amp;minLat=(ANY)&amp;maxLat=(ANY)&amp;minTime=(ANY)&amp;maxTime=(ANY)&amp;searchFor=all
</pre></div></div>
</div>
<p>There are many responses available, see the docs for
<a class="reference external" href="http://coastwatch.pfeg.noaa.gov/erddap/griddap/documentation.html">griddap</a>
and
<a class="reference external" href="http://coastwatch.pfeg.noaa.gov/erddap/tabledap/documentation.html">tabledap</a>
respectively. The most useful ones for Pythonistas are the <code class="docutils literal notranslate"><span class="pre">.csv</span></code> and
<code class="docutils literal notranslate"><span class="pre">.nc</span></code> that can be read with pandas and netCDF4-python respectively.</p>
<p>Let’s load the <code class="docutils literal notranslate"><span class="pre">csv</span></code> reponse directly with <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">get_search_url</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">,</span> <span class="n">search_for</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="s1">&#39;We have </span><span class="si">{}</span><span class="s1"> tabledap, </span><span class="si">{}</span><span class="s1"> griddap, and </span><span class="si">{}</span><span class="s1"> wms endpoints.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tabledap&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())),</span>
    <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;griddap&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())),</span>
    <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;wms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()))</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[9]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;We have 432 tabledap, 0 griddap, and 0 wms endpoints.&#39;
</pre></div>
</div>
</div>
<p>We can refine our search by providing some constraints.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">show_iframe</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helper function to show HTML returns.&quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">HTML</span>
    <span class="n">iframe</span> <span class="o">=</span> <span class="s1">&#39;&lt;iframe src=&quot;</span><span class="si">{src}</span><span class="s1">&quot; width=&quot;100%&quot; height=&quot;950&quot;&gt;&lt;/iframe&gt;&#39;</span><span class="o">.</span><span class="n">format</span>
    <span class="k">return</span> <span class="n">HTML</span><span class="p">(</span><span class="n">iframe</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Let’s narrow the search area, time span, and look for
<code class="docutils literal notranslate"><span class="pre">sea_water_temperature</span></code> only.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">kw</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;sea_water_temperature&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min_lon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">72.0</span><span class="p">,</span>
    <span class="s1">&#39;max_lon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">69.0</span><span class="p">,</span>
    <span class="s1">&#39;min_lat&#39;</span><span class="p">:</span> <span class="mf">38.0</span><span class="p">,</span>
    <span class="s1">&#39;max_lat&#39;</span><span class="p">:</span> <span class="mf">41.0</span><span class="p">,</span>
    <span class="s1">&#39;min_time&#39;</span><span class="p">:</span> <span class="s1">&#39;2016-07-10T00:00:00Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;max_time&#39;</span><span class="p">:</span> <span class="s1">&#39;2017-02-10T00:00:00Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cdm_data_type&#39;</span><span class="p">:</span> <span class="s1">&#39;trajectoryprofile&#39;</span>
<span class="p">}</span>

<span class="n">search_url</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">get_search_url</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="n">show_iframe</span><span class="p">(</span><span class="n">search_url</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<iframe src="https://data.ioos.us/gliders/erddap/search/advanced.html?page=1&itemsPerPage=1000&protocol=(ANY)&cdm_data_type=trajectoryprofile&institution=(ANY)&ioos_category=(ANY)&keywords=(ANY)&long_name=(ANY)&standard_name=sea_water_temperature&variableName=(ANY)&minLon=-72.0&maxLon=-69.0&minLat=38.0&maxLat=41.0&minTime=1468108800.0&maxTime=1486684800.0" width="100%" height="950"></iframe></div>
</div>
<p>We can see that the search form above was correctly populated with the
constraints we provided.</p>
<p>Let us change the response from <code class="docutils literal notranslate"><span class="pre">.html</span></code> to <code class="docutils literal notranslate"><span class="pre">.csv</span></code>, so we load it as
a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, and inspect what are the <code class="docutils literal notranslate"><span class="pre">Dataset</span> <span class="pre">ID</span></code>s
available for download.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">search_url</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">get_search_url</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="n">search</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">search_url</span><span class="p">)</span>
<span class="n">gliders</span> <span class="o">=</span> <span class="n">search</span><span class="p">[</span><span class="s1">&#39;Dataset ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found </span><span class="si">{}</span><span class="s1"> Glider Datasets:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gliders</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gliders</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Found 17 Glider Datasets:
allrutgersGliders
blue-20160818T1448
cp_335-20170116T1459
cp_336-20161011T0027
cp_336-20170116T1254
cp_340-20160809T0230
cp_374-20160529T0035
cp_374-20161011T0106
cp_376-20160527T2050
cp_379-20170116T1246
cp_380-20161011T2046
cp_387-20160404T1858
cp_388-20160809T1409
cp_389-20161011T2040
silbo-20160413T1534
sp022-20170209T1616
whoi_406-20160902T1700
</pre></div></div>
</div>
<p>Now that we know the <code class="docutils literal notranslate"><span class="pre">Dataset</span> <span class="pre">ID</span></code>s we can explore their metadata
with the <code class="docutils literal notranslate"><span class="pre">get_info_url</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">info_url</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">get_info_url</span><span class="p">(</span><span class="n">dataset_id</span><span class="o">=</span><span class="n">gliders</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">response</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">)</span>

<span class="n">show_iframe</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">info_url</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<iframe src="https://data.ioos.us/gliders/erddap/info/allrutgersGliders/index.html" width="100%" height="950"></iframe></div>
</div>
<p>Again, with the <code class="docutils literal notranslate"><span class="pre">csv</span></code> response, we can manipulate the metadata and
find the variables that have the <code class="docutils literal notranslate"><span class="pre">cdm_profile_variables</span></code> attribute.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">info_url</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">get_info_url</span><span class="p">(</span><span class="n">dataset_id</span><span class="o">=</span><span class="n">gliders</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">response</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">)</span>

<span class="n">info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">info_url</span><span class="p">)</span>

<span class="n">info</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Row Type</th>
      <th>Variable Name</th>
      <th>Attribute Name</th>
      <th>Data Type</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>attribute</td>
      <td>NC_GLOBAL</td>
      <td>acknowledgment</td>
      <td>String</td>
      <td>This deployment supported by funding from the ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>attribute</td>
      <td>NC_GLOBAL</td>
      <td>cdm_data_type</td>
      <td>String</td>
      <td>TrajectoryProfile</td>
    </tr>
    <tr>
      <th>2</th>
      <td>attribute</td>
      <td>NC_GLOBAL</td>
      <td>cdm_profile_variables</td>
      <td>String</td>
      <td>profile_id, time, latitude, longitude, time_uv...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>attribute</td>
      <td>NC_GLOBAL</td>
      <td>cdm_trajectory_variables</td>
      <td>String</td>
      <td>trajectory, wmo_id</td>
    </tr>
    <tr>
      <th>4</th>
      <td>attribute</td>
      <td>NC_GLOBAL</td>
      <td>contributor_name</td>
      <td>String</td>
      <td>Josh Kohut, Dave Aragon, Chip Haldeman, Nicole...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Attribute Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cdm_profile_variables&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[15]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;profile_id, time, latitude, longitude, time_uv, lat_uv, lon_uv, u, v&#39;
</pre></div>
</div>
</div>
<p>Selecting variables by theirs attributes is such a common operation that
<code class="docutils literal notranslate"><span class="pre">erddapy</span></code> brings its own method to simplify this task.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">get_var_by_attr</span></code> method is inspired by <code class="docutils literal notranslate"><span class="pre">netCDF4-python</span></code>’s
<code class="docutils literal notranslate"><span class="pre">get_variables_by_attributes</span></code> however, because <code class="docutils literal notranslate"><span class="pre">erddapy</span></code> is
operating on remote serves, it will return the variable names instead of
the actual variables.</p>
<p>Here we check what is/are the variable(s) associated with the
<code class="docutils literal notranslate"><span class="pre">standard_name</span></code> used in the search.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">get_var_by_attr</span></code> caches the last response in case the user
needs to make multiple requests, but it will loose its state when a new
request is made.</p>
<p>(See the execution times below.)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">time</span>

# First one, slow.
e.get_var_by_attr(
    dataset_id=&#39;blue-20160818T1448&#39;,
    standard_name=&#39;sea_water_temperature&#39;
)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CPU times: user 300 ms, sys: 11.9 ms, total: 312 ms
Wall time: 2.02 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[16]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&#39;temperature&#39;]
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">time</span>

# Second one on the same glider, a little bit faster.
e.get_var_by_attr(
    dataset_id=&#39;blue-20160818T1448&#39;,
    standard_name=&#39;sea_water_practical_salinity&#39;
)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CPU times: user 21.4 ms, sys: 272 µs, total: 21.6 ms
Wall time: 814 ms
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[17]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&#39;salinity&#39;]
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">time</span>

# New one, slow.
e.get_var_by_attr(
    dataset_id=&#39;cp_336-20170116T1254&#39;,
    standard_name=&#39;sea_water_practical_salinity&#39;
)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CPU times: user 154 ms, sys: 16 µs, total: 154 ms
Wall time: 1.44 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[18]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&#39;salinity&#39;]
</pre></div>
</div>
</div>
<p>With Python it is easy to loop over all the <code class="docutils literal notranslate"><span class="pre">dataset_id</span></code>s for the
variables with <code class="docutils literal notranslate"><span class="pre">standard_names</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">variables</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">e</span><span class="o">.</span><span class="n">get_var_by_attr</span><span class="p">(</span>
        <span class="n">dataset_id</span><span class="o">=</span><span class="n">glider</span><span class="p">,</span>
        <span class="n">standard_name</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">glider</span> <span class="ow">in</span> <span class="n">gliders</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>We can construct a <code class="docutils literal notranslate"><span class="pre">set</span></code> with the common variables in those
<code class="docutils literal notranslate"><span class="pre">dataset_id</span></code>s.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">common_variables</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="o">*</span><span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

<span class="n">common_variables</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[20]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>{&#39;conductivity&#39;,
 &#39;conductivity_qc&#39;,
 &#39;density&#39;,
 &#39;density_qc&#39;,
 &#39;depth&#39;,
 &#39;depth_qc&#39;,
 &#39;lat_uv&#39;,
 &#39;lat_uv_qc&#39;,
 &#39;latitude&#39;,
 &#39;latitude_qc&#39;,
 &#39;lon_uv&#39;,
 &#39;lon_uv_qc&#39;,
 &#39;longitude&#39;,
 &#39;longitude_qc&#39;,
 &#39;precise_lat&#39;,
 &#39;precise_lon&#39;,
 &#39;precise_time&#39;,
 &#39;precise_time_qc&#39;,
 &#39;pressure&#39;,
 &#39;pressure_qc&#39;,
 &#39;salinity&#39;,
 &#39;salinity_qc&#39;,
 &#39;temperature&#39;,
 &#39;temperature_qc&#39;,
 &#39;time&#39;,
 &#39;time_qc&#39;,
 &#39;time_uv&#39;,
 &#39;time_uv_qc&#39;,
 &#39;u&#39;,
 &#39;u_qc&#39;,
 &#39;v&#39;,
 &#39;v_qc&#39;}
</pre></div>
</div>
</div>
<p>Last, but not least, the download endpoint!</p>
<p>It is important to note that the download constraints are based on the
variables names and not the standardized ones for the <code class="docutils literal notranslate"><span class="pre">get_search_url</span></code>
method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">constraints</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;longitude&gt;=&#39;</span><span class="p">:</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;min_lon&#39;</span><span class="p">],</span>
    <span class="s1">&#39;longitude&lt;=&#39;</span><span class="p">:</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;max_lon&#39;</span><span class="p">],</span>
    <span class="s1">&#39;latitude&gt;=&#39;</span><span class="p">:</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;min_lat&#39;</span><span class="p">],</span>
    <span class="s1">&#39;latitude&lt;=&#39;</span><span class="p">:</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;max_lat&#39;</span><span class="p">],</span>
    <span class="s1">&#39;time&gt;=&#39;</span><span class="p">:</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;min_time&#39;</span><span class="p">],</span>
    <span class="s1">&#39;time&lt;=&#39;</span><span class="p">:</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;max_time&#39;</span><span class="p">],</span>
<span class="p">}</span>



<span class="n">download_url</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">get_download_url</span><span class="p">(</span>
    <span class="n">dataset_id</span><span class="o">=</span><span class="n">gliders</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">protocol</span><span class="o">=</span><span class="s1">&#39;tabledap&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="n">common_variables</span><span class="p">,</span>
    <span class="n">constraints</span><span class="o">=</span><span class="n">constraints</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">download_url</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
https://data.ioos.us/gliders/erddap/tabledap/allrutgersGliders.html?temperature_qc,u,v,precise_lon,latitude,pressure_qc,time_qc,lat_uv_qc,salinity,conductivity_qc,u_qc,time_uv_qc,conductivity,time_uv,time,density,lat_uv,longitude,precise_time,v_qc,depth_qc,lon_uv,depth,precise_time_qc,precise_lat,longitude_qc,temperature,salinity_qc,pressure,latitude_qc,lon_uv_qc,density_qc&amp;longitude&gt;=-72.0&amp;longitude&lt;=-69.0&amp;latitude&gt;=38.0&amp;latitude&lt;=41.0&amp;time&gt;=1468108800.0&amp;time&lt;=1486684800.0
</pre></div></div>
</div>
<p>Putting everything in <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">requests.exceptions</span> <span class="k">import</span> <span class="n">HTTPError</span>


<span class="k">def</span> <span class="nf">download_csv</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
        <span class="n">url</span><span class="p">,</span>
        <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>
        <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>


<span class="n">dfs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">glider</span> <span class="ow">in</span> <span class="n">gliders</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">download_url</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">get_download_url</span><span class="p">(</span>
            <span class="n">dataset_id</span><span class="o">=</span><span class="n">glider</span><span class="p">,</span>
            <span class="n">protocol</span><span class="o">=</span><span class="s1">&#39;tabledap&#39;</span><span class="p">,</span>
            <span class="n">variables</span><span class="o">=</span><span class="n">common_variables</span><span class="p">,</span>
            <span class="n">response</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">,</span>
            <span class="n">constraints</span><span class="o">=</span><span class="n">constraints</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="n">HTTPError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Failed to download </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">glider</span><span class="p">))</span>
        <span class="k">continue</span>
    <span class="n">dfs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">glider</span><span class="p">:</span> <span class="n">download_csv</span><span class="p">(</span><span class="n">download_url</span><span class="p">)})</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Failed to download allrutgersGliders
Failed to download silbo-20160413T1534
Failed to download sp022-20170209T1616
</pre></div></div>
</div>
<p>The glider datasets should be masked automatically but we found that is
not true. The cell below applies the mask as described by the data QC
flag.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">for</span> <span class="n">glider</span> <span class="ow">in</span> <span class="n">dfs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">dfs</span><span class="p">[</span><span class="n">glider</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfs</span><span class="p">[</span><span class="n">glider</span><span class="p">][</span><span class="s1">&#39;salinity_qc&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;salinity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
    <span class="n">dfs</span><span class="p">[</span><span class="n">glider</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfs</span><span class="p">[</span><span class="n">glider</span><span class="p">][</span><span class="s1">&#39;pressure_qc&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
    <span class="n">dfs</span><span class="p">[</span><span class="n">glider</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfs</span><span class="p">[</span><span class="n">glider</span><span class="p">][</span><span class="s1">&#39;temperature_qc&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
    <span class="n">dfs</span><span class="p">[</span><span class="n">glider</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfs</span><span class="p">[</span><span class="n">glider</span><span class="p">][</span><span class="s1">&#39;salinity&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;salinity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
</pre></div>
</div>
</div>
<p>Finally let’s see some figures!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.ticker</span> <span class="k">import</span> <span class="n">LongitudeFormatter</span><span class="p">,</span> <span class="n">LatitudeFormatter</span>


<span class="k">def</span> <span class="nf">make_map</span><span class="p">(</span><span class="n">extent</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
        <span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="n">extent</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">lon_formatter</span> <span class="o">=</span> <span class="n">LongitudeFormatter</span><span class="p">(</span><span class="n">zero_direction_label</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lat_formatter</span> <span class="o">=</span> <span class="n">LatitudeFormatter</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lon_formatter</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lat_formatter</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>


<span class="n">dx</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">extent</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;min_lon&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;max_lon&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;min_lat&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">dy</span><span class="p">,</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;max_lat&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">dy</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">make_map</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
<span class="k">for</span> <span class="n">glider</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dfs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">glider</span><span class="p">)</span>

<span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/quick_intro_42_0.png" src="_images/quick_intro_42_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">glider_scatter</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">glider</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;salinity&#39;</span><span class="p">],</span>
               <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">glider</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;salinity&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;temperature&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">glider</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dfs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">glider_scatter</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">glider</span><span class="p">)</span>

<span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/quick_intro_43_0.png" src="_images/quick_intro_43_0.png" />
</div>
</div>
<div class="section" id="Extras">
<h2>Extras<a class="headerlink" href="#Extras" title="Permalink to this headline">¶</a></h2>
<div class="section" id="OPeNDAP-response">
<h3>OPeNDAP response<a class="headerlink" href="#OPeNDAP-response" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">e</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">e</span><span class="o">.</span><span class="n">protocol</span> <span class="o">=</span> <span class="s1">&#39;tabledap&#39;</span>

<span class="n">opendap_url</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">get_download_url</span><span class="p">(</span>
    <span class="n">dataset_id</span><span class="o">=</span><span class="s1">&#39;cp_336-20170116T1254&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">opendap_url</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
https://data.ioos.us/gliders/erddap/tabledap/cp_336-20170116T1254
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">netCDF4</span> <span class="k">import</span> <span class="n">Dataset</span>


<span class="k">with</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">opendap_url</span><span class="p">)</span> <span class="k">as</span> <span class="n">nc</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">summary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The Pioneer Array is located off the coast of New England, south of Martha&#39;s Vineyard. The Continental Shelf-Slope area off the New England coast is a highly productive area and one that is located at a dynamic intersection where ocean currents meet in weather-like &#39;fronts&#39;, and where nutrients, pollutants, and other properties are exchanged between the coast and the deep ocean. Data from the inshore, shelf area helps to examine exchanges between the shelf and slope and the shelf ecosystem, as well as provide broader insight into the issues of air-sea gas exchange, including Carbon Dioxide. In order to provide synoptic, multi-scale observations of the outer continental shelf, shelf break region, and continental slope, the moored portion of the Pioneer Array is supplemented by six Coastal Gliders. The role of the Coastal Gliders is to monitor the mesoscale field of the slope sea and outer shelf, resolving rings, eddies and meanders from the Gulf Stream as they impinge on the shelf break front.  This dataset contains profiles of conductivity, temperature, depth, salinity and density, which are either measured or derived from the CTD measurements.
</pre></div></div>
</div>
</div>
<div class="section" id="netCDF-“file-like”-to-xarray">
<h3>netCDF “file-like” to xarray<a class="headerlink" href="#netCDF-“file-like”-to-xarray" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">open_dataset</span></code> will download a temporary file, so be careful with the
constraints to avoid downloading several gigabytes!</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">e</span><span class="o">.</span><span class="n">dataset_id</span> <span class="o">=</span> <span class="s1">&#39;cp_336-20170116T1254&#39;</span>
<span class="n">e</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="s1">&#39;nc&#39;</span>
<span class="n">e</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">common_variables</span>
<span class="n">e</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="n">constraints</span>

<span class="n">download_url</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">get_download_url</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">requests</span>


<span class="k">def</span> <span class="nf">humansize</span><span class="p">(</span><span class="n">nbytes</span><span class="p">):</span>
    <span class="n">suffixes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;KB&#39;</span><span class="p">,</span> <span class="s1">&#39;MB&#39;</span><span class="p">,</span> <span class="s1">&#39;GB&#39;</span><span class="p">,</span> <span class="s1">&#39;TB&#39;</span><span class="p">,</span> <span class="s1">&#39;PB&#39;</span><span class="p">]</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">nbytes</span> <span class="o">&gt;=</span> <span class="mi">1024</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">suffixes</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">nbytes</span> <span class="o">/=</span> <span class="mf">1024.</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">nbytes</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">suffixes</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">download_url</span><span class="p">)</span>
<span class="n">nbytes</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Length&#39;</span><span class="p">])</span>
<span class="n">humansize</span><span class="p">(</span><span class="n">nbytes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[29]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;602.58 KB&#39;
</pre></div>
</div>
</div>
<p>That is the uncompressed size, we are OK because the download will be
less than that, <code class="docutils literal notranslate"><span class="pre">ERDDAP</span></code> streams gzip’ed data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Encoding&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[30]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;gzip&#39;
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[31]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;xarray.Dataset&gt;
Dimensions:          (row: 16232)
Coordinates:
    latitude         (row) float64 ...
    time_uv          (row) float64 ...
    time             (row) float64 ...
    lat_uv           (row) float64 ...
    longitude        (row) float64 ...
    lon_uv           (row) float64 ...
    depth            (row) float32 ...
Dimensions without coordinates: row
Data variables:
    temperature_qc   (row) float32 ...
    u                (row) float64 ...
    v                (row) float64 ...
    precise_lon      (row) float64 ...
    pressure_qc      (row) float32 ...
    time_qc          (row) float32 ...
    lat_uv_qc        (row) float32 ...
    salinity         (row) float32 ...
    conductivity_qc  (row) float32 ...
    u_qc             (row) float32 ...
    time_uv_qc       (row) float32 ...
    conductivity     (row) float32 ...
    density          (row) float32 ...
    precise_time     (row) float64 ...
    v_qc             (row) float32 ...
    depth_qc         (row) float32 ...
    precise_time_qc  (row) float32 ...
    precise_lat      (row) float64 ...
    longitude_qc     (row) float32 ...
    temperature      (row) float32 ...
    salinity_qc      (row) float32 ...
    pressure         (row) float64 ...
    latitude_qc      (row) float32 ...
    lon_uv_qc        (row) float32 ...
    density_qc       (row) float32 ...
Attributes:
    acknowledgement:               Funding provided by the National Science F...
    cdm_data_type:                 TrajectoryProfile
    cdm_profile_variables:         profile_id, time, latitude, longitude, tim...
    cdm_trajectory_variables:      trajectory, wmo_id
    contributor_name:              Paul Matthias,Peter Brickley,Sheri White,D...
    contributor_role:              CGSN Program Manager,CGSN Operations Engin...
    Conventions:                   Unidata Dataset Discovery v1.0, COARDS, CF...
    creator_email:                 kerfoot@marine.rutgers.edu
    creator_name:                  John Kerfoot
    creator_url:                   http://rucool.marine.rutgers.edu
    date_created:                  2017-04-19T14:33:41Z
    date_issued:                   2017-04-19T14:33:41Z
    date_modified:                 2017-04-19T14:33:41Z
    deployment_number:             4
    Easternmost_Easting:           -69.98303682074565
    featureType:                   TrajectoryProfile
    format_version:                https://github.com/ioos/ioosngdac/tree/mas...
    geospatial_lat_max:            39.91726417227544
    geospatial_lat_min:            39.32370673037986
    geospatial_lat_units:          degrees_north
    geospatial_lon_max:            -69.98303682074565
    geospatial_lon_min:            -71.18259602604894
    geospatial_lon_units:          degrees_east
    geospatial_vertical_max:       976.756
    geospatial_vertical_min:       -0.03969577
    geospatial_vertical_positive:  down
    geospatial_vertical_units:     m
    history:                       2017-04-19T14:33:35Z: Data Source /Users/k...
    id:                            cp_336-20170116T1254_e698_69e3_e309
    infoUrl:                       http://data.ioos.us/gliders/erddap/
    institution:                   Ocean Observatories Initiative
    ioos_dac_checksum:             f42b729c0bf19af1b7229b21350ebaaf
    ioos_dac_completed:            False
    keywords:                      AUVS &gt; Autonomous Underwater Vehicles, Oce...
    keywords_vocabulary:           GCMD Science Keywords
    license:                       All OOI data including data from OOI core ...
    Metadata_Conventions:          Unidata Dataset Discovery v1.0, COARDS, CF...
    metadata_link:                 http://ooi.visualocean.net/sites/view/CP05...
    naming_authority:              org.oceanobservatories
    Northernmost_Northing:         39.91726417227544
    platform_type:                 Slocum Glider
    processing_level:              Contains any/all of the following: L0 Data...
    project:                       Ocean Observatories Initiative
    publisher_email:               kerfoot@marine.rutgers.edu
    publisher_name:                John Kerfoot
    publisher_url:                 http://rucool.marine.rutgers.edu
    references:                    http://oceanobservatories.org/
    sea_name:                      Mid-Atlantic Bight
    source:                        Observational data from a profiling glider
    sourceUrl:                     (local files)
    Southernmost_Northing:         39.32370673037986
    standard_name_vocabulary:      CF Standard Name Table v27
    subsetVariables:               trajectory, wmo_id, profile_id, time, lati...
    summary:                       The Pioneer Array is located off the coast...
    time_coverage_end:             2017-02-09T23:03:25Z
    time_coverage_start:           2017-01-16T13:03:04Z
    title:                         cp_336-20170116T1254
    Westernmost_Easting:           -71.18259602604894
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[32]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;xarray.DataArray &#39;temperature&#39; (row: 16232)&gt;
array([14.3976, 14.4236, 14.4596, ...,  4.4004,  4.3975,  4.3978],
      dtype=float32)
Coordinates:
    latitude   (row) float64 ...
    time_uv    (row) float64 ...
    time       (row) float64 ...
    lat_uv     (row) float64 ...
    longitude  (row) float64 ...
    lon_uv     (row) float64 ...
    depth      (row) float32 ...
Dimensions without coordinates: row
Attributes:
    _ChunkSizes:          1
    actual_range:         [ 0.     17.2652]
    ancillary_variables:  temperature_qc
    colorBarMaximum:      32.0
    colorBarMinimum:      0.0
    instrument:           instrument_ctd
    ioos_category:        Temperature
    long_name:            Sea Water Temperature
    observation_type:     measured
    platform:             platform
    source_variable:      sci_water_temp
    standard_name:        sea_water_temperature
    units:                degree_Celsius
    valid_max:            40.0
    valid_min:            -5.0
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">depth</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">mask</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mask</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">depth</span> <span class="o">=</span> <span class="n">depth</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">warnings</span>


<span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">depth</span> <span class="o">&lt;=</span> <span class="mi">5</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">depth</span> <span class="o">=</span> <span class="n">depth</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">lon</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">lat</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>


<span class="n">dx</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">extent</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">geospatial_lon_min</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">geospatial_lon_max</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">geospatial_lat_min</span><span class="o">-</span><span class="n">dy</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">geospatial_lat_max</span><span class="o">+</span><span class="n">dy</span>
<span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">make_map</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>

<span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                    <span class="n">fraction</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="s1">&#39;10m&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/quick_intro_57_0.png" src="_images/quick_intro_57_0.png" />
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2017, Filipe Fernandes.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/quick_intro.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/pyoceans/erddapy" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>